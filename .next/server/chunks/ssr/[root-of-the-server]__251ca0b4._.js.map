{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ryanr/next-shop/src/app/page.js"],"sourcesContent":["\"use client\";\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { Editor } from '@tinymce/tinymce-react';\nimport { Store, UserCircle, Star, ArrowLeft, PlusCircle, Video, Trash2, Edit, LogOut, ShieldCheck, GripVertical, ChevronDown, ChevronUp, X, Eye, Search, UserMinus, Users, FolderPlus } from 'lucide-react';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, onIdTokenChanged, signOut, signInWithEmailAndPassword } from \"firebase/auth\";\nimport { getFirestore, collection, addDoc, doc, updateDoc, deleteDoc, query, where, onSnapshot, serverTimestamp, getDocs, writeBatch, orderBy, setDoc } from \"firebase/firestore\";\nimport { getStorage, ref as storageRef, uploadBytesResumable, getDownloadURL, deleteObject } from \"firebase/storage\";\nimport { getFunctions, httpsCallable } from \"firebase/functions\";\n\n\n// --- FIREBASE INITIALIZATION ---\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDiCbTkbfn3LHAZnvlBxYZEDU1Ng_LftdA\",\n  authDomain: \"nextshop-a17fe.firebaseapp.com\",\n  projectId: \"nextshop-a17fe\",\n  storageBucket: \"nextshop-a17fe.firebasestorage.app\",\n  messagingSenderId: \"135352358131\",\n  appId: \"1:135352358131:web:1eed317a816366721f1386\",\n  measurementId: \"G-98EJ5Y0RMG\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\nconst storage = getStorage(app);\nconst functions = getFunctions(app, 'us-central1');\n\n\n// --- SUPER ADMIN CONFIGURATION ---\nconst SUPER_ADMIN_UID = \"RnBej9HSStVJXA0rtIB02W0R1yv2\";\n\n\n// --- UI COMPONENTS ---\n\nconst StarRating = ({ rating, reviewCount }) => (\n    <div className=\"flex items-center\">\n        <div className=\"flex items-center\">{[...Array(5)].map((_, i) => (<Star key={i} className={`h-4 w-4 ${i < Math.round(rating) ? 'text-yellow-400 fill-current' : 'text-gray-300'}`} />))}</div>\n        {reviewCount !== undefined && <span className=\"ml-2 text-sm text-gray-500\">({reviewCount})</span>}\n    </div>\n);\n\nconst Header = ({ setView, user, onSignOut, searchQuery, setSearchQuery }) => {\n    const isSuperAdmin = (user && user.customClaims && user.customClaims.superAdmin === true) || (user && user.uid === SUPER_ADMIN_UID);\n    return (\n        <header className=\"bg-white shadow-md sticky top-0 z-50\">\n            <nav className=\"container mx-auto px-4 py-3 flex justify-between items-center gap-4\">\n                <div className=\"flex items-center space-x-2 cursor-pointer flex-shrink-0\" onClick={() => setView({ page: 'home' })}><Store className=\"h-8 w-8 text-blue-600\" /><span className=\"text-2xl font-bold text-gray-800\">ShopNext</span></div>\n                \n                {user && (\n                    <div className=\"relative w-full max-w-lg\">\n                        <input\n                            type=\"search\"\n                            placeholder=\"Search by product name or tag...\"\n                            value={searchQuery}\n                            onChange={(e) => setSearchQuery(e.target.value)}\n                            className=\"w-full pl-10 pr-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        />\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    </div>\n                )}\n                \n                {user && (\n                    <div className=\"flex items-center space-x-4 flex-shrink-0\">\n                        <button onClick={() => setView({ page: 'dashboard' })} className={`flex items-center space-x-2 text-white px-4 py-2 rounded-full transition-colors bg-blue-600 hover:bg-blue-700 cursor-pointer`}>\n                            {isSuperAdmin ? <ShieldCheck className=\"h-5 w-5\" /> : <UserCircle className=\"h-5 w-5\" />}\n                            <span>My Dashboard</span>\n                        </button>\n                        <button onClick={onSignOut} title=\"Sign Out\" className=\"text-gray-500 hover:text-red-600 transition-colors cursor-pointer\"><LogOut className=\"h-6 w-6\" /></button>\n                    </div>\n                )}\n            </nav>\n        </header>\n    );\n};\n\nconst Footer = () => (\n    <footer className=\"bg-gray-800 text-white mt-12\"><div className=\"container mx-auto px-4 py-6 text-center\"><p>&copy; 2025 ShopNext. All rights reserved.</p><p className=\"text-sm text-gray-300\">A prototype for educational purposes.</p></div></footer>\n);\n\nconst ProductCard = ({ product, setView }) => (\n    <div className=\"bg-white border rounded-lg shadow-sm overflow-hidden hover:shadow-lg transition-shadow duration-300 group flex flex-col\">\n        <div className=\"relative aspect-square\">\n            <img src={product.imageUrl || 'https://placehold.co/600x600/e2e8f0/4a5568?text=Image'} alt={product.name} className=\"w-full h-full object-cover\" />\n        </div>\n        <div className=\"p-4 flex flex-col flex-grow\">\n            <h3 className=\"text-lg font-bold text-gray-800 truncate\">{product.name}</h3>\n            <p className=\"text-sm text-gray-500 mb-2 truncate\">{product.subtitle}</p>\n            <div className=\"flex-grow\">\n                 <div className=\"flex flex-wrap gap-1 mb-2\">{(product.tags || []).slice(0, 3).map(tag => <span key={tag} className=\"bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full text-xs font-semibold\">#{tag}</span>)}</div>\n            </div>\n            <div className=\"flex justify-between items-center mt-2\"><p className=\"text-xl font-extrabold text-blue-600\">${parseFloat(product.price).toFixed(2)}</p><StarRating rating={product.rating} reviewCount={product.reviewCount} /></div>\n            <button onClick={() => setView({ page: 'product', id: product.id })} className=\"mt-4 w-full bg-blue-500 text-white py-2 rounded-full font-semibold hover:bg-blue-600 transition-colors cursor-pointer\">View Details</button>\n        </div>\n    </div>\n);\n\nconst ProductGrid = ({ products, setView, sortOrder, setSortOrder }) => {\n    return (\n        <main className=\"container mx-auto px-4 pt-8 pb-2\">\n            <div className=\"flex justify-between items-center mb-6\">\n                 <h2 className=\"text-3xl font-extrabold text-gray-900\">Products</h2>\n                 <div className=\"flex items-center space-x-2\">\n                    <label htmlFor=\"sort-order\" className=\"text-sm font-medium text-gray-700\">Sort by:</label>\n                    <select \n                        id=\"sort-order\"\n                        value={sortOrder}\n                        onChange={(e) => setSortOrder(e.target.value)}\n                        className=\"p-2 border rounded-md text-sm\"\n                    >\n                        <option value=\"featured\">Featured</option>\n                        <option value=\"price-asc\">Price: Low to High</option>\n                        <option value=\"price-desc\">Price: High to Low</option>\n                        <option value=\"rating-desc\">Highest Rating</option>\n                        <option value=\"newest\">Newest Arrivals</option>\n                    </select>\n                 </div>\n            </div>\n            {products.length > 0 ? (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n                    {products.map(product => (<ProductCard key={product.id} product={product} setView={setView} />))}\n                </div>\n            ) : (\n                <div className=\"text-center py-16\">\n                    <p className=\"text-gray-500 text-lg\">No products found.</p>\n                    <p className=\"text-gray-600 text-sm\">Try adjusting your search or filter, or for admins, select a class to view.</p>\n                </div>\n            )}\n        </main>\n    );\n};\n\nconst ReviewFormComponent = ({ productId, user }) => {\n    const [ratings, setRatings] = useState({ attention: 0, persuasion: 0, brandedRecall: 0, liking: 0 });\n    const [text, setText] = useState(''); const [error, setError] = useState(''); const [success, setSuccess] = useState('');\n    const criteria = ['attention', 'persuasion', 'brandedRecall', 'liking'];\n    const handleRatingChange = (criterion, value) => { setRatings(prev => ({ ...prev, [criterion]: value })); };\n    const updateProductRatingAfterSubmission = async () => { const reviewsRef = collection(db, \"products\", productId, \"reviews\"); const reviewsSnapshot = await getDocs(reviewsRef); const newReviewCount = reviewsSnapshot.size; let totalRating = 0; reviewsSnapshot.forEach(doc => { totalRating += doc.data().overallRating; }); const newAverageRating = newReviewCount > 0 ? totalRating / newReviewCount : 0; await updateDoc(doc(db, \"products\", productId), { rating: newAverageRating, reviewCount: newReviewCount }); };\n    const handleReviewSubmit = async (e) => { e.preventDefault(); setError(''); setSuccess(''); if (Object.values(ratings).some(r => r === 0) || !text) { setError('Please provide a rating for all criteria and write a review.'); return; } const overallRating = Object.values(ratings).reduce((a, b) => a + b, 0) / criteria.length; try { await addDoc(collection(db, \"products\", productId, \"reviews\"), { userId: user.uid, username: user.displayName, ...ratings, overallRating, text, createdAt: serverTimestamp() }); await updateProductRatingAfterSubmission(); setSuccess('Thank you for your review!'); setRatings({ attention: 0, persuasion: 0, brandedRecall: 0, liking: 0 }); setText(''); } catch (err) { setError('Failed to submit review. ' + err.message); } };\n    return (<div className=\"bg-white p-6 rounded-lg shadow-md border mt-8\"><h3 className=\"text-xl font-bold text-gray-800 mb-4\">Leave a Review</h3><form onSubmit={handleReviewSubmit} className=\"space-y-4\">{criteria.map(criterion => (<div key={criterion} className=\"flex flex-col sm:flex-row justify-between sm:items-center\"><span className=\"capitalize text-gray-700 mb-2 sm:mb-0\">{criterion.replace(/([A-Z])/g, ' $1')}</span><div className=\"flex\">{[...Array(5)].map((_, i) => (<Star key={i} className={`h-6 w-6 cursor-pointer ${i < ratings[criterion] ? 'text-yellow-400 fill-current' : 'text-gray-300'}`} onClick={() => handleRatingChange(criterion, i + 1)} />))}</div></div>))}<div><textarea value={text} onChange={(e) => setText(e.target.value)} rows=\"4\" placeholder=\"Share your thoughts...\" className=\"w-full mt-2 p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"></textarea></div>{error && <p className=\"text-sm text-red-500 text-center\">{error}</p>}{success && <p className=\"text-sm text-green-500 text-center\">{success}</p>}<button type=\"submit\" className=\"w-full py-2 bg-blue-600 text-white rounded-full font-semibold hover:bg-blue-700 cursor-pointer\">Submit Review</button></form></div>);\n};\n\nconst ProductPage = ({ product, setView, user }) => {\n    const initialMedia = (product.imageUrls && product.imageUrls.length > 0) ? { type: 'image', src: product.imageUrls[0] } : { type: 'image', src: 'https://placehold.co/600x600/e2e8f0/4a5568?text=Image' };\n    const [activeMedia, setActiveMedia] = useState(initialMedia);\n    const [reviews, setReviews] = useState([]);\n    const [isDetailsOpen, setIsDetailsOpen] = useState(false);\n    useEffect(() => { const unsubscribe = onSnapshot(query(collection(db, \"products\", product.id, \"reviews\"), orderBy(\"createdAt\", \"desc\")), (snapshot) => { setReviews(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))); }); return () => unsubscribe(); }, [product.id]);\n    const allMedia = [...(product.imageUrls || []).map(src => ({ type: 'image', src })), ...(product.videoUrls || []).map(src => ({ type: 'video', src }))];\n    return (<main className=\"container mx-auto px-4 py-8\"><button onClick={() => setView({ page: 'home' })} className=\"flex items-center text-blue-600 hover:underline mb-6 cursor-pointer\"><ArrowLeft className=\"mr-2 h-4 w-4\" /> Back to products</button><div className=\"grid grid-cols-1 md:grid-cols-2 gap-12\"><div><div className=\"mb-4 w-full h-auto aspect-square bg-gray-100 rounded-lg overflow-hidden shadow-lg flex items-center justify-center\"><div className=\"w-full h-full\">{activeMedia.type === 'image' ? (<img src={activeMedia.src} alt={product.name} className=\"w-full h-full object-cover\" />) : (<video key={activeMedia.src} src={activeMedia.src} controls autoPlay muted className=\"w-full h-full object-cover\"></video>)}</div></div><div className=\"flex flex-wrap gap-2\">{allMedia.map((media, index) => (<button key={index} onClick={() => setActiveMedia(media)} className={`w-20 h-20 rounded-md overflow-hidden border-2 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer ${activeMedia.src === media.src ? 'border-blue-500' : 'border-transparent'}`}>{media.type === 'image' ? (<img src={media.src} alt={`thumbnail ${index + 1}`} className=\"w-full h-full object-cover\" />) : (<div className=\"w-full h-full bg-black flex items-center justify-center relative\"><div className=\"absolute inset-0 bg-black opacity-50\"></div><Video className=\"h-8 w-8 text-white z-10\" /></div>)}</button>))}</div></div><div><h1 className=\"text-4xl font-extrabold text-gray-900 mt-1\">{product.name}</h1><p className=\"text-lg text-gray-600 mt-2\">{product.subtitle}</p><div className=\"my-4\"><StarRating rating={product.rating} reviewCount={product.reviewCount} /></div><p className=\"text-3xl font-bold text-blue-600\">${parseFloat(product.price).toFixed(2)}</p>\n        {/* MODIFIED: Use dangerouslySetInnerHTML to render formatted short description */}\n        <div className=\"mt-6 border-t pt-4 short-description\">\n            <div className=\"text-gray-700 prose max-w-none\" dangerouslySetInnerHTML={{ __html: product.shortDescription }} />\n        </div>\n        <div className=\"mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4\">{(product.highlights || []).map((highlight, index) => (<div key={index} className=\"bg-blue-50 p-4 rounded-lg border border-blue-100\"><p className=\"font-bold text-blue-800\">{highlight.title}</p><p className=\"text-sm text-blue-700 mt-1\">{highlight.text}</p></div>))}</div></div></div><div className=\"mt-12 max-w-[1100px] mx-auto\"><div className=\"border-t\"><button onClick={() => setIsDetailsOpen(!isDetailsOpen)} className=\"w-full flex justify-between items-center py-4 text-left cursor-pointer\"><div><h2 className=\"text-2xl font-bold text-gray-800\">About this item</h2><p className=\"text-sm text-gray-500\">Product Details</p></div>{isDetailsOpen ? <ChevronUp className=\"h-6 w-6\" /> : <ChevronDown className=\"h-6 w-6\" />}</button>\n        {/* MODIFIED: Use dangerouslySetInnerHTML to render formatted long description */}\n        {isDetailsOpen && (<div className=\"pb-4 text-gray-600 prose max-w-none long-description\" dangerouslySetInnerHTML={{ __html: product.longDescription }}/>)}\n        </div></div><div className=\"mt-12 max-w-[1100px] mx-auto\"><h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Customer Reviews</h2>{reviews.length > 0 ? (<div className=\"space-y-6\">{reviews.map(review => (<div key={review.id} className=\"bg-white p-4 rounded-lg shadow-sm border\"><div className=\"flex items-center mb-2\"><StarRating rating={review.overallRating} /><span className=\"ml-4 font-bold text-gray-800\">{review.username}</span></div><p className=\"text-gray-600\">{review.text}</p></div>))}</div>) : (<p className=\"text-gray-500\">No reviews yet. Be the first to share your thoughts!</p>)}{user && <ReviewFormComponent productId={product.id} user={user} />}</div></main>);\n};\n\nconst LoginScreen = () => {\n    const [username, setUsername] = useState(''); const [password, setPassword] = useState(''); const [error, setError] = useState(''); const [isLoading, setIsLoading] = useState(false);\n    const formatEmail = (user) => `${user.trim()}@shopnext.dev`;\n    const handleSignIn = async (e) => { e.preventDefault(); setError(''); setIsLoading(true); try { await signInWithEmailAndPassword(auth, formatEmail(username), password); } catch (err) { setError(err.message); } setIsLoading(false); };\n    return (<div className=\"flex items-center justify-center min-h-[80vh] bg-gray-50\"><div className=\"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-xl border\"><div className=\"flex justify-center\"><Store className=\"h-12 w-12 text-blue-600\" /></div><h2 className=\"text-2xl font-bold text-center text-gray-800\">Welcome to ShopNext</h2><p className=\"text-center text-gray-500\">Please sign in to view products.</p><form onSubmit={handleSignIn} className=\"space-y-4\"><div><label className=\"text-sm font-medium text-gray-700\">Username</label><input type=\"text\" value={username} onChange={(e) => setUsername(e.target.value)} className=\"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\" required/></div><div><label className=\"text-sm font-medium text-gray-700\">Password</label><input type=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} className=\"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\" required/></div>{error && <p className=\"text-sm text-red-500 text-center\">{error}</p>}<button type=\"submit\" disabled={isLoading} className=\"w-full py-3 font-semibold text-white bg-blue-600 rounded-full hover:bg-blue-700 transition-colors flex items-center justify-center disabled:bg-blue-300 cursor-pointer\">{isLoading ? 'Signing In...' : 'Sign In'}</button></form></div></div>);\n};\n\nconst CreateProductForm = ({ setVendorView, user, editingProduct }) => {\n    const [product, setProduct] = useState({ name: '', subtitle: '', shortDescription: '', longDescription: '', price: '', category: '' });\n    // This state is for handling TinyMCE's initialization\n    const [editorLoaded, setEditorLoaded] = useState(false);\n    const [tags, setTags] = useState([]);\n    const [tagInput, setTagInput] = useState('');\n    const [highlights, setHighlights] = useState([{ title: '', text: '' }]);\n    const [media, setMedia] = useState([]);\n    const [draggedMedia, setDraggedMedia] = useState(null);\n    const [isUploading, setIsUploading] = useState(false);\n    const [error, setError] = useState('');\n    const [success, setSuccess] = useState('');\n    const fileInputRef = useRef(null);\n\n    // This makes sure the editor loads correctly with initial data\n    useEffect(() => {\n        if (editingProduct) {\n            setProduct({ name: editingProduct.name || '', subtitle: editingProduct.subtitle || '', shortDescription: editingProduct.shortDescription || '', longDescription: editingProduct.longDescription || '', price: editingProduct.price || '', category: editingProduct.category || '' });\n            setTags(editingProduct.tags || []);\n            setHighlights(editingProduct.highlights && editingProduct.highlights.length > 0 ? editingProduct.highlights : [{ title: '', text: '' }]);\n            const existingMedia = [\n                ...(editingProduct.imageUrls || []).map(url => ({ url, type: 'image' })),\n                ...(editingProduct.videoUrls || []).map(url => ({ url, type: 'video' }))\n            ];\n            setMedia(existingMedia);\n        } else {\n            setProduct({ name: '', subtitle: '', shortDescription: '', longDescription: '', price: '', category: '' });\n            setTags([]);\n            setHighlights([{ title: '', text: '' }]);\n            setMedia([]);\n        }\n        // Mark the editor as ready to load\n        setEditorLoaded(true);\n    }, [editingProduct]);\n\n    // Handlers for file uploads and other form elements (no changes needed here)\n    const handleFileChange = (e) => {\n        const files = Array.from(e.target.files);\n        const imageCount = media.filter(m => m.type === 'image').length;\n        const videoCount = media.filter(m => m.type === 'video').length;\n        let allowedFiles = [];\n        let localError = '';\n\n        files.forEach(file => {\n            const fileType = file.type.startsWith('image/') ? 'image' : (file.type.startsWith('video/') ? 'video' : null);\n            if (fileType === 'image' && imageCount + allowedFiles.filter(f => f.type === 'image').length < 5) {\n                allowedFiles.push({ file, type: 'image' });\n            } else if (fileType === 'video' && videoCount + allowedFiles.filter(f => f.type === 'video').length < 2) {\n                allowedFiles.push({ file, type: 'video' });\n            } else {\n                localError = `Upload limit reached. Max 5 images and 2 videos.`;\n            }\n        });\n\n        if (localError) setError(localError);\n        allowedFiles.forEach(item => handleFileUpload(item.file, item.type));\n    };\n    const handleFileUpload = (file, fileType) => {\n        if (!file) return;\n        setIsUploading(true);\n        setError('');\n        const folder = fileType === 'image' ? 'products' : 'product-videos';\n        const fileRef = storageRef(storage, `${folder}/${Date.now()}_${file.name}`);\n        const uploadTask = uploadBytesResumable(fileRef, file);\n        uploadTask.on('state_changed', () => {}, (error) => { setError(`Upload failed for ${file.name}: ${error.message}`); setIsUploading(false); }, () => { getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => { setMedia(prev => [...prev, { url: downloadURL, type: fileType }]); setIsUploading(false); }); });\n    };\n    const handleRemoveMedia = async (urlToRemove) => {\n        if (window.confirm(\"Are you sure you want to remove this media?\")) {\n            try {\n                const fileRef = storageRef(storage, urlToRemove);\n                await deleteObject(fileRef);\n                setMedia(prev => prev.filter(item => item.url !== urlToRemove));\n            } catch (error) {\n                console.error(\"Failed to delete media: \", error);\n                if (error.code === 'storage/object-not-found') { setMedia(prev => prev.filter(item => item.url !== urlToRemove)); } else { setError(\"Failed to remove media. Please try again.\"); }\n            }\n        }\n    };\n    const handleDragStart = (e, item) => setDraggedMedia(item);\n    const handleDragOver = (e) => e.preventDefault();\n    const handleDrop = (e, targetItem) => {\n        if (!draggedMedia) return;\n        const currentIndex = media.findIndex(item => item.url === draggedMedia.url);\n        const targetIndex = media.findIndex(item => item.url === targetItem.url);\n        if (currentIndex === -1 || targetIndex === -1) return;\n        const newMedia = [...media];\n        newMedia.splice(currentIndex, 1);\n        newMedia.splice(targetIndex, 0, draggedMedia);\n        setMedia(newMedia);\n        setDraggedMedia(null);\n    };\n    const handleChange = (e) => { const { name, value } = e.target; setProduct(prev => ({ ...prev, [name]: value })); };\n    const handleTagInput = (e) => { if ((e.key === ',' || e.key === 'Enter') && tagInput.trim() !== '') { e.preventDefault(); if (!tags.includes(tagInput.trim())) { setTags([...tags, tagInput.trim()]); } setTagInput(''); } };\n    const removeTag = (tagToRemove) => { setTags(tags.filter(tag => tag !== tagToRemove)); };\n    const handleHighlightChange = (index, field, value) => { const newHighlights = [...highlights]; newHighlights[index][field] = value; setHighlights(newHighlights); };\n    const addHighlight = () => { if (highlights.length < 6) setHighlights([...highlights, { title: '', text: '' }]); };\n    const removeHighlight = (index) => { if (highlights.length > 1 || (highlights.length === 1 && (highlights[0].title || highlights[0].text))) { setHighlights(highlights.filter((_, i) => i !== index)); } };\n    const handleSaveProduct = async (e) => {\n        e.preventDefault();\n        setError('');\n        setSuccess('');\n        if (!product.name || !product.price) { setError('Product Name and Price are required.'); return; }\n        const imageUrls = media.filter(m => m.type === 'image').map(m => m.url);\n        const videoUrls = media.filter(m => m.type === 'video').map(m => m.url);\n        try {\n            const commonData = { ...product, price: parseFloat(product.price), tags, highlights: highlights.filter(h => h.title && h.text), imageUrls, videoUrls, imageUrl: imageUrls.length > 0 ? imageUrls[0] : '', class: editingProduct ? editingProduct.class : user.customClaims.class };\n            if (editingProduct) {\n                await updateDoc(doc(db, \"products\", editingProduct.id), { ...commonData, featuredOrder: editingProduct.featuredOrder !== undefined ? editingProduct.featuredOrder : 999 });\n                setSuccess('Product updated successfully!');\n            } else {\n                await addDoc(collection(db, \"products\"), { ...commonData, vendorId: user.uid, vendor: user.displayName, createdAt: serverTimestamp(), rating: 0, reviewCount: 0, featuredOrder: Date.now() });\n                setSuccess('Product saved successfully!');\n            }\n            setTimeout(() => { setVendorView('dashboard'); }, 1500);\n        } catch (err) {\n            setError('Failed to save product. ' + err.message);\n        }\n    };\n    \n    // Only render the form once the editor is ready to prevent issues\n    if (!editorLoaded) {\n        return <div>Loading Editor...</div>;\n    }\n\n    return (\n        <div className=\"bg-white p-8 rounded-lg shadow-md border max-w-3xl mx-auto\">\n            <h3 className=\"text-xl font-bold mb-6 text-gray-800\">{editingProduct ? 'Edit Product' : 'Add New Product'}</h3>\n            <form onSubmit={handleSaveProduct} className=\"space-y-6\">\n                <div><label>Product Name</label><input name=\"name\" value={product.name} onChange={handleChange} className=\"w-full mt-1 p-2 border rounded-md\"/></div>\n                <div><label>Subtitle</label><input name=\"subtitle\" value={product.subtitle} onChange={handleChange} className=\"w-full mt-1 p-2 border rounded-md\"/></div>\n                \n                <div>\n                    <label>Short Description</label>\n                    <Editor\n                        apiKey=\"gl7xxa4bfui10kjofcwnkiuznxaxy3y2aabdso6929tltmkq\" // <-- PASTE YOUR KEY HERE\n                        value={product.shortDescription}\n                        onEditorChange={(content) => setProduct(prev => ({ ...prev, shortDescription: content }))}\n                        init={{\n                            height: 250,\n                            menubar: false,\n                            plugins: 'lists link emoticons help wordcount',\n                            toolbar: 'undo redo | bold italic underline | bullist numlist | link emoticons | help',\n                            content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:14px }'\n                        }}\n                    />\n                </div>\n\n                <div><label>Product Highlights (Up to 6)</label>{highlights.map((h, i) => (<div key={i} className=\"flex items-center gap-2 mt-2\"><input value={h.title} onChange={(e) => handleHighlightChange(i, 'title', e.target.value)} placeholder=\"Bold Title\" className=\"p-2 border rounded-md w-1/3\"/><input value={h.text} onChange={(e) => handleHighlightChange(i, 'text', e.target.value)} placeholder=\"Sub-headline\" className=\"p-2 border rounded-md flex-grow\"/><button type=\"button\" onClick={() => removeHighlight(i)} className=\"p-2 text-red-500 hover:bg-red-100 rounded-full cursor-pointer\"><X size={16}/></button></div>))}{highlights.length < 6 && <button type=\"button\" onClick={addHighlight} className=\"text-sm text-blue-600 mt-2 font-semibold cursor-pointer\">Add Highlight</button>}</div>\n                \n                <div>\n                    <label>Long Description</label>\n                     <Editor\n                        apiKey=\"gl7xxa4bfui10kjofcwnkiuznxaxy3y2aabdso6929tltmkq\" // <-- PASTE YOUR KEY HERE\n                        value={product.longDescription}\n                        onEditorChange={(content) => setProduct(prev => ({ ...prev, longDescription: content }))}\n                        init={{\n                            height: 400,\n                            menubar: true,\n                            plugins: 'advlist lists link image charmap preview anchor searchreplace visualblocks code fullscreen insertdatetime media table help wordcount',\n                            toolbar: 'undo redo | blocks | bold italic underline forecolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help',\n                            content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:14px }'\n                        }}\n                    />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\"><div><label>Price</label><input name=\"price\" value={product.price} onChange={handleChange} type=\"number\" step=\"0.01\" className=\"w-full mt-1 p-2 border rounded-md\"/></div><div><label>Category</label><input name=\"category\" value={product.category} onChange={handleChange} className=\"w-full mt-1 p-2 border rounded-md\"/></div></div><div><label>Tags</label><div className=\"flex flex-wrap gap-2 p-2 border rounded-md mt-1\">{tags.map(tag => (<span key={tag} className=\"flex items-center bg-gray-200 rounded-full px-3 py-1 text-sm\">{tag}<button type=\"button\" onClick={() => removeTag(tag)} className=\"ml-2 text-gray-500 hover:text-gray-800 cursor-pointer\"><X size={14}/></button></span>))}<input value={tagInput} onChange={(e) => setTagInput(e.target.value)} onKeyDown={handleTagInput} placeholder=\"Add tag...\" className=\"flex-grow p-1 focus:outline-none\"/></div><p className=\"text-xs text-gray-500 mt-1\">Press Enter or comma to add a tag.</p></div><div>\n                    <p className=\"block text-sm font-medium text-gray-700 mb-2\">Product Media</p>\n                    <div className=\"text-xs text-gray-500 p-3 bg-gray-50 rounded-md border mb-3\"><ul className=\"list-none space-y-1\"><li>Up to <b>5 photos</b> (JPEG, PNG, WEBP) and <b>2 videos</b> (MP4).</li><li>For best results, use square <b>600x600</b> pixel images.</li><li><b>Drag and drop</b> media to reorder. The first image will be your featured image.</li></ul></div>\n                    <input type=\"file\" ref={fileInputRef} onChange={handleFileChange} className=\"hidden\" accept=\"image/jpeg,image/png,image/webp,video/mp4\" multiple /><button type=\"button\" onClick={() => fileInputRef.current.click()} disabled={isUploading} className=\"flex items-center justify-center w-full py-2 px-4 border border-dashed rounded-md cursor-pointer\"> <PlusCircle className=\"h-5 w-5 mr-2\"/>Add Media</button>\n                    <div className=\"mt-4 flex flex-wrap gap-4\">{media.map((item, index) => (<div key={item.url} draggable onDragStart={(e) => handleDragStart(e, item)} onDragOver={handleDragOver} onDrop={(e) => handleDrop(e, item)} className=\"relative w-24 h-24 rounded-md cursor-move group\">{item.type === 'image' ? <img src={item.url} className=\"w-full h-full object-cover rounded-md\"/> : <div className=\"w-full h-full bg-black rounded-md flex items-center justify-center\"><Video className=\"h-8 w-8 text-white\"/></div>}<button type=\"button\" onClick={() => handleRemoveMedia(item.url)} className=\"absolute -top-2 -right-2 bg-red-600 text-white rounded-full p-1 shadow-lg opacity-100 lg:opacity-0 lg:group-hover:opacity-100 transition-opacity cursor-pointer\"><Trash2 size={14}/></button>{index === 0 && media.find(m => m.type === 'image')?.url === item.url && <div className=\"absolute bottom-0 w-full bg-black bg-opacity-60 text-white text-center text-xs py-0.5 rounded-b-md\">Featured</div>}</div>))}</div>\n                </div>{error && <p className=\"text-sm text-red-500 text-center\">{error}</p>}{success && <p className=\"text-sm text-green-500 text-center\">{success}</p>}<div className=\"flex justify-end space-x-4\"><button type=\"button\" onClick={() => setVendorView('dashboard')} className=\"px-6 py-2 border rounded-full cursor-pointer\">Cancel</button><button type=\"submit\" disabled={isUploading} className=\"px-6 py-2 bg-blue-600 text-white rounded-full cursor-pointer\">{isUploading ? 'Uploading...' : 'Save Product'}</button></div>\n            </form>\n        </div>\n    );\n};\n\nconst VendorDashboard = ({ user, setView, onEditProduct }) => {\n    const [vendorProducts, setVendorProducts] = useState([]);\n    useEffect(() => { if (user) { const q = query(collection(db, \"products\"), where(\"vendorId\", \"==\", user.uid)); const unsubscribe = onSnapshot(q, (snapshot) => { setVendorProducts(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))); }); return () => unsubscribe(); } }, [user]);\n    const handleDeleteProduct = async (product) => { if(window.confirm(\"Are you sure?\")) { try { await deleteDoc(doc(db, \"products\", product.id)); (product.imageUrls || []).forEach(url => deleteObject(storageRef(storage, url))); (product.videoUrls || []).forEach(url => deleteObject(storageRef(storage, url))); } catch (error) { console.error(\"Error deleting product: \", error); } }};\n    return (<div><div className=\"flex justify-between items-center mb-6\"><div><h2 className=\"text-2xl font-bold text-gray-800\">My Products ({vendorProducts.length})</h2><p className=\"text-sm text-gray-500\">Logged in as: {user?.displayName} (Class: {user?.customClaims.class})</p></div><button onClick={() => { onEditProduct(null); setView({ page: 'create_product' });}} className=\"flex items-center bg-blue-600 text-white px-4 py-2 rounded-full font-semibold hover:bg-blue-700 transition-colors mr-4 cursor-pointer\"><PlusCircle className=\"h-5 w-5 mr-2\" />Add New Product</button></div><div className=\"bg-white rounded-lg shadow-md border overflow-hidden\"><table className=\"min-w-full divide-y divide-gray-200\"><thead className=\"bg-gray-50\"><tr><th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Product</th><th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Price</th><th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Rating</th><th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">Actions</th></tr></thead><tbody className=\"bg-white divide-y divide-gray-200\">{vendorProducts.map(p => (<tr key={p.id}><td className=\"px-6 py-4\"><div className=\"flex items-center\"><img className=\"h-10 w-10 rounded-md object-cover mr-4\" src={p.imageUrl || p.imageUrls?.[0] || 'https://placehold.co/100x100/e2e8f0/4a5568?text=Img'} alt={p.name} /><span className=\"font-medium text-gray-900\">{p.name}</span></div></td><td className=\"px-6 py-4 text-gray-600\">${parseFloat(p.price).toFixed(2)}</td><td className=\"px-6 py-4\"><StarRating rating={p.rating} reviewCount={p.reviewCount} /></td><td className=\"px-6 py-4\"><div className=\"flex space-x-4\"><button onClick={() => onEditProduct(p)} className=\"text-blue-600 hover:text-blue-800 cursor-pointer\"><Edit className=\"h-5 w-5\" /></button><button onClick={() => handleDeleteProduct(p)} className=\"text-red-600 hover:text-red-800 cursor-pointer\"><Trash2 className=\"h-5 w-5\" /></button></div></td></tr>))}</tbody></table></div></div>);\n};\n\n// Modal Component\nconst Modal = ({ isOpen, onClose, title, children }) => {\n    if (!isOpen) return null;\n    return (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\" onClick={onClose}>\n            <div className=\"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto\" onClick={(e) => e.stopPropagation()}>\n                <div className=\"flex justify-between items-center p-6 border-b\">\n                    <h3 className=\"text-xl font-bold text-gray-800\">{title}</h3>\n                    <button onClick={onClose} className=\"text-gray-400 hover:text-gray-600 cursor-pointer\"><X className=\"h-6 w-6\" /></button>\n                </div>\n                <div className=\"p-6\">{children}</div>\n            </div>\n        </div>\n    );\n};\n\n// Manage Users Modal\nconst DeleteUsersModal = ({ isOpen, onClose }) => {\n    const [users, setUsers] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const [message, setMessage] = useState('');\n\n    useEffect(() => {\n        if (isOpen) {\n            setMessage('');\n            setUsers([]);\n            fetchUsers();\n        }\n    }, [isOpen]);\n\n    const fetchUsers = async () => {\n        setLoading(true);\n        setMessage('');\n        try {\n            const listAllUsers = httpsCallable(functions, 'listAllUsers');\n            const result = await listAllUsers();\n\n            console.log('Users fetched:', result.data);\n\n            if (result.data && result.data.users) {\n                setUsers(result.data.users);\n            } else {\n                setUsers([]);\n                setMessage('No users returned from server');\n            }\n        } catch (error) {\n            console.error('Error fetching users:', error);\n            setUsers([]);\n\n            // Better error messages\n            if (error.code === 'functions/unauthenticated') {\n                setMessage('Error: You must be logged in');\n            } else if (error.code === 'functions/permission-denied') {\n                setMessage('Error: You do not have permission');\n            } else if (error.code === 'functions/not-found') {\n                setMessage('Error: Function not deployed. Run: firebase deploy --only functions');\n            } else {\n                setMessage(`Error: ${error.message || 'Unknown error occurred'}`);\n            }\n        }\n        setLoading(false);\n    };\n\n    const handleDeleteUser = async (uid, email) => {\n        if (!window.confirm(`Are you sure you want to delete user ${email}?`)) return;\n\n        setLoading(true);\n        setMessage('');\n        try {\n            const deleteUser = httpsCallable(functions, 'deleteUser');\n            await deleteUser({ uid });\n            setMessage(`User ${email} deleted successfully`);\n            await fetchUsers();\n        } catch (error) {\n            console.error('Error deleting user:', error);\n            if (error.code === 'functions/not-found') {\n                setMessage('Error: Function not deployed. Run: firebase deploy --only functions');\n            } else {\n                setMessage(`Error: ${error.message || 'Unknown error occurred'}`);\n            }\n        }\n        setLoading(false);\n    };\n\n    return (\n        <Modal isOpen={isOpen} onClose={onClose} title=\"Manage Users\">\n            <div className=\"space-y-4\">\n                {loading && <p className=\"text-center text-gray-500\">Loading...</p>}\n                {message && <p className={`text-sm text-center ${message.startsWith('Error') ? 'text-red-500' : 'text-green-600'}`}>{message}</p>}\n                {!loading && !message && users.length === 0 && <p className=\"text-center text-gray-500\">No users found</p>}\n                {!loading && users.length > 0 && (\n                    <div className=\"space-y-2\">\n                        {users.map(user => (\n                            <div key={user.uid} className=\"flex justify-between items-center p-4 border rounded-lg hover:bg-gray-50\">\n                                <div>\n                                    <p className=\"font-medium text-gray-900\">{user.email}</p>\n                                    <p className=\"text-xs text-gray-500\">UID: {user.uid}</p>\n                                    {user.customClaims?.class && <p className=\"text-xs text-blue-600\">Class: {user.customClaims.class}</p>}\n                                </div>\n                                <button\n                                    onClick={() => handleDeleteUser(user.uid, user.email)}\n                                    className=\"flex items-center space-x-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors cursor-pointer\"\n                                >\n                                    <UserMinus className=\"h-4 w-4\" />\n                                    <span className=\"text-sm\">Delete</span>\n                                </button>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n        </Modal>\n    );\n};\n\n// Manage Classes Modal\nconst ManageClassesModal = ({ isOpen, onClose }) => {\n    const [classes, setClasses] = useState([]);\n    const [newClassName, setNewClassName] = useState('');\n    const [message, setMessage] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    useEffect(() => {\n        if (isOpen) {\n            const q = query(collection(db, \"classes\"));\n            const unsubscribe = onSnapshot(q, (snapshot) => {\n                setClasses(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));\n            });\n            return () => unsubscribe();\n        }\n    }, [isOpen]);\n\n    const handleAddClass = async (e) => {\n        e.preventDefault();\n        if (!newClassName.trim()) {\n            setMessage('Error: Class name cannot be empty');\n            return;\n        }\n\n        setLoading(true);\n        setMessage('');\n        try {\n            const className = newClassName.trim().toLowerCase().replace(/\\s+/g, '-');\n            const displayName = newClassName.trim().charAt(0).toUpperCase() + newClassName.trim().slice(1);\n            await setDoc(doc(db, \"classes\", className), { name: displayName });\n            setMessage(`Class \"${displayName}\" added successfully`);\n            setNewClassName('');\n        } catch (error) {\n            setMessage(`Error: ${error.message}`);\n        }\n        setLoading(false);\n    };\n\n    const handleDeleteClass = async (classId, className) => {\n        if (!window.confirm(`Are you sure you want to delete class \"${className}\"? This will not delete associated products or users.`)) return;\n\n        setLoading(true);\n        setMessage('');\n        try {\n            await deleteDoc(doc(db, \"classes\", classId));\n            setMessage(`Class \"${className}\" deleted successfully`);\n        } catch (error) {\n            setMessage(`Error: ${error.message}`);\n        }\n        setLoading(false);\n    };\n\n    return (\n        <Modal isOpen={isOpen} onClose={onClose} title=\"Manage Classes\">\n            <div className=\"space-y-6\">\n                <form onSubmit={handleAddClass} className=\"space-y-4\">\n                    <div>\n                        <label className=\"text-sm font-medium text-gray-700\">Add New Class</label>\n                        <div className=\"flex gap-2 mt-2\">\n                            <input\n                                type=\"text\"\n                                value={newClassName}\n                                onChange={(e) => setNewClassName(e.target.value)}\n                                placeholder=\"e.g., Morning Class\"\n                                className=\"flex-1 p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            />\n                            <button\n                                type=\"submit\"\n                                disabled={loading}\n                                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 flex items-center space-x-2 cursor-pointer\"\n                            >\n                                <FolderPlus className=\"h-4 w-4\" />\n                                <span>Add</span>\n                            </button>\n                        </div>\n                    </div>\n                </form>\n\n                {message && <p className={`text-sm text-center ${message.startsWith('Error') ? 'text-red-500' : 'text-green-600'}`}>{message}</p>}\n\n                <div>\n                    <h4 className=\"font-medium text-gray-700 mb-3\">Existing Classes</h4>\n                    {classes.length === 0 ? (\n                        <p className=\"text-center text-gray-500\">No classes created yet</p>\n                    ) : (\n                        <div className=\"space-y-2\">\n                            {classes.map(cls => (\n                                <div key={cls.id} className=\"flex justify-between items-center p-4 border rounded-lg hover:bg-gray-50\">\n                                    <div>\n                                        <p className=\"font-medium text-gray-900\">{cls.name}</p>\n                                        <p className=\"text-xs text-gray-500\">ID: {cls.id}</p>\n                                    </div>\n                                    <button\n                                        onClick={() => handleDeleteClass(cls.id, cls.name)}\n                                        className=\"flex items-center space-x-2 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors cursor-pointer\"\n                                    >\n                                        <Trash2 className=\"h-4 w-4\" />\n                                        <span className=\"text-sm\">Delete</span>\n                                    </button>\n                                </div>\n                            ))}\n                        </div>\n                    )}\n                </div>\n            </div>\n        </Modal>\n    );\n};\n\nconst SuperAdminDashboard = ({ user, onEditProduct }) => {\n    const [allProducts, setAllProducts] = useState([]);\n    const [classes, setClasses] = useState([]);\n    const [selectedClass, setSelectedClass] = useState('');\n    const [draggedItem, setDraggedItem] = useState(null);\n    const [newUser, setNewUser] = useState({username: '', password: '', class: ''});\n    const [userCreationMsg, setUserCreationMsg] = useState('');\n    const [isLoadingUserCreation, setIsLoadingUserCreation] = useState(false);\n    const [showDeleteUsersModal, setShowDeleteUsersModal] = useState(false);\n    const [showManageClassesModal, setShowManageClassesModal] = useState(false);\n\n    useEffect(() => {\n        const q = query(collection(db, \"classes\"));\n        const unsubscribe = onSnapshot(q, (snapshot) => {\n            const classList = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n            setClasses(classList);\n            if (classList.length > 0 && !selectedClass) {\n                setSelectedClass(classList[0].id);\n            }\n        });\n        return () => unsubscribe();\n    }, []);\n\n    useEffect(() => {\n        if (!selectedClass) {\n            setAllProducts([]);\n            return;\n        };\n        const q = query(collection(db, \"products\"), where(\"class\", \"==\", selectedClass), orderBy(\"featuredOrder\", \"asc\"));\n        const unsubscribe = onSnapshot(q, (snapshot) => {\n            const prods = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n            setAllProducts(prods);\n        });\n        return () => unsubscribe();\n    }, [selectedClass]);\n\n    const handleDeleteProduct = async (product) => { if(window.confirm(\"Are you sure?\")) { try { await deleteDoc(doc(db, \"products\", product.id)); (product.imageUrls || []).forEach(url => deleteObject(storageRef(storage, url))); (product.videoUrls || []).forEach(url => deleteObject(storageRef(storage, url))); } catch (error) { console.error(\"Error deleting product: \", error); } }};\n    const handleDragStart = (e, index) => { setDraggedItem(allProducts[index]); };\n    const handleDragOver = (e, index) => { e.preventDefault(); const draggedOverItem = allProducts[index]; if (draggedItem === draggedOverItem) { return; } let items = allProducts.filter(item => item !== draggedItem); items.splice(index, 0, draggedItem); setAllProducts(items); };\n    const handleDragEnd = async () => { setDraggedItem(null); const batch = writeBatch(db); allProducts.forEach((product, index) => { const productRef = doc(db, \"products\", product.id); batch.update(productRef, { featuredOrder: index }); }); await batch.commit(); };\n\n    const handleCreateUser = async (e) => {\n        e.preventDefault();\n        if (newUser.username.length < 3 || newUser.password.length < 6 || !newUser.class) {\n            setUserCreationMsg(\"Error: Please fill all fields correctly.\");\n            return;\n        }\n        setIsLoadingUserCreation(true);\n        setUserCreationMsg('');\n        try {\n            const createNewVendor = httpsCallable(functions, 'createNewVendor');\n            const result = await createNewVendor({\n                username: newUser.username,\n                password: newUser.password,\n                class: newUser.class\n            });\n            \n            const className = newUser.class.trim().toLowerCase();\n            const classRef = doc(db, \"classes\", className);\n            const displayName = className.charAt(0).toUpperCase() + className.slice(1).replace(/-/g, ' ');\n            await setDoc(classRef, { name: displayName });\n\n            setUserCreationMsg(result.data.result);\n            setNewUser({ username: '', password: '', class: '' });\n        } catch (error) {\n            setUserCreationMsg(`Error: ${error.message}`);\n        }\n        setIsLoadingUserCreation(false);\n    };\n    \n    return (\n        <div>\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-6\">Super Admin Dashboard</h2>\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n                <div className=\"lg:col-span-2\">\n                     <div className=\"flex items-center mb-4\">\n                        <label htmlFor=\"class-select\" className=\"mr-2 font-bold\">Manage Class:</label>\n                        {classes.length > 0 ? (\n                           <select id=\"class-select\" value={selectedClass} onChange={(e) => setSelectedClass(e.target.value)} className=\"p-2 border rounded-md\">{classes.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}</select>\n                        ) : (\n                           <p className=\"text-gray-500\">No classes created yet.</p>\n                        )}\n                     </div>\n                     <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Product Order (Drag to Reorder)</h3>\n                     <div className=\"bg-white rounded-lg shadow-md border overflow-hidden\">{allProducts.map((p, index) => (<div key={p.id} draggable onDragStart={(e) => handleDragStart(e, index)} onDragOver={(e) => handleDragOver(e, index)} onDragEnd={handleDragEnd} className=\"flex items-center justify-between p-4 border-b last:border-b-0 cursor-move\"><div className=\"flex items-center\"><GripVertical className=\"h-5 w-5 text-gray-400 mr-4\" /><img className=\"h-10 w-10 rounded-md object-cover mr-4\" src={p.imageUrl || p.imageUrls?.[0]} alt={p.name} /><div><p className=\"font-medium text-gray-900\">{p.name}</p><p className=\"text-xs text-gray-500\">{p.vendor}</p></div></div><div className=\"flex space-x-4\"><button onClick={() => onEditProduct(p)} className=\"text-blue-600 hover:text-blue-800 cursor-pointer\"><Edit className=\"h-5 w-5\" /></button><button onClick={() => handleDeleteProduct(p)} className=\"text-red-600 hover:text-red-800 cursor-pointer\"><Trash2 className=\"h-5 w-5\" /></button></div></div>))}</div>\n                </div>\n                <div className=\"space-y-6\">\n                    <div>\n                        <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Create New Vendor</h3>\n                        <div className=\"bg-white p-6 rounded-lg shadow-md border\">\n                            <form onSubmit={handleCreateUser} className=\"space-y-4\">\n                                <div><label className=\"text-sm font-medium\">Username</label><input type=\"text\" value={newUser.username} onChange={(e) => setNewUser({...newUser, username: e.target.value})} className=\"w-full mt-1 p-2 border rounded-md\" required/></div>\n                                <div><label className=\"text-sm font-medium\">Password</label><input type=\"password\" value={newUser.password} onChange={(e) => setNewUser({...newUser, password: e.target.value})} className=\"w-full mt-1 p-2 border rounded-md\" required/></div>\n                                <div><label className=\"text-sm font-medium\">Assign to Class</label><input type=\"text\" value={newUser.class} onChange={(e) => setNewUser({...newUser, class: e.target.value})} placeholder=\"e.g., morning-class\" className=\"w-full mt-1 p-2 border rounded-md\" required/></div>\n                                <button type=\"submit\" disabled={isLoadingUserCreation} className=\"w-full py-2 bg-blue-600 text-white rounded-full font-semibold hover:bg-blue-700 disabled:bg-blue-300 cursor-pointer\">{isLoadingUserCreation ? 'Creating...' : 'Create Vendor'}</button>\n                                {userCreationMsg && <p className={`text-xs text-center mt-2 ${userCreationMsg.startsWith('Error') ? 'text-red-500' : 'text-green-600'}`}>{userCreationMsg}</p>}\n                            </form>\n                        </div>\n                    </div>\n\n                    <div>\n                        <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Admin Actions</h3>\n                        <div className=\"bg-white p-6 rounded-lg shadow-md border space-y-3\">\n                            <button\n                                onClick={() => setShowDeleteUsersModal(true)}\n                                className=\"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer\"\n                            >\n                                <Users className=\"h-5 w-5\" />\n                                <span>Manage Users</span>\n                            </button>\n                            <button\n                                onClick={() => setShowManageClassesModal(true)}\n                                className=\"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors cursor-pointer\"\n                            >\n                                <FolderPlus className=\"h-5 w-5\" />\n                                <span>Manage Classes</span>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Modals */}\n            <DeleteUsersModal isOpen={showDeleteUsersModal} onClose={() => setShowDeleteUsersModal(false)} />\n            <ManageClassesModal isOpen={showManageClassesModal} onClose={() => setShowManageClassesModal(false)} />\n        </div>\n    );\n};\n\nconst AdminClassSelector = ({ classes, adminViewingClass, setAdminViewingClass }) => (\n    <div className=\"container mx-auto px-4 pt-6 pb-2 bg-blue-50 border-b border-blue-200\">\n        <div className=\"flex items-center space-x-3 bg-white p-4 rounded-lg shadow-sm border border-blue-200\">\n            <Eye className=\"h-6 w-6 text-blue-600\" />\n            <label htmlFor=\"admin-class-select\" className=\"font-bold text-gray-700\">Admin View:</label>\n            <select \n                id=\"admin-class-select\" \n                value={adminViewingClass} \n                onChange={(e) => setAdminViewingClass(e.target.value)} \n                className=\"p-2 border rounded-md w-full max-w-xs\"\n            >\n                <option value=\"\">-- Select a Class to View --</option>\n                {classes.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\n            </select>\n        </div>\n    </div>\n);\n\n\n// --- MAIN APP COMPONENT ---\nexport default function App() {\n  const [view, setView] = useState({ page: 'home', id: null });\n  const [products, setProducts] = useState([]);\n  const [user, setUser] = useState(null); \n  const [loading, setLoading] = useState(true); \n  const [classes, setClasses] = useState([]);\n  const [adminViewingClass, setAdminViewingClass] = useState('');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [sortOrder, setSortOrder] = useState('featured');\n\n\n  const handleSignOut = async () => { \n      setAdminViewingClass(''); \n      await signOut(auth); \n  };\n\n  useEffect(() => { \n      const unsubscribe = onIdTokenChanged(auth, async (currentUser) => {\n          if (currentUser) {\n              const tokenResult = await currentUser.getIdTokenResult();\n              currentUser.customClaims = tokenResult.claims;\n              setUser(currentUser);\n          } else {\n              setUser(null);\n          }\n          setLoading(false);\n      });\n      return () => unsubscribe(); \n  }, []);\n\n  // FIXED: Add useEffect to scroll to top on view change\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [view]);\n\n  useEffect(() => {\n    const q = query(collection(db, \"classes\"));\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n        setClasses(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));\n    });\n    return () => unsubscribe();\n  }, []);\n  \n  useEffect(() => { \n      if (!user) {\n          setProducts([]);\n          return;\n      }\n      \n      const isSuperAdmin = (user.customClaims && user.customClaims.superAdmin === true) || user.uid === SUPER_ADMIN_UID;\n      let q;\n\n      if (isSuperAdmin) {\n          if (adminViewingClass) {\n            q = query(collection(db, \"products\"), where(\"class\", \"==\", adminViewingClass), orderBy(\"featuredOrder\", \"asc\"));\n          } else {\n            setProducts([]);\n            return; // Return early if no class is selected\n          }\n      } else if (user.customClaims.class) {\n          q = query(collection(db, \"products\"), where(\"class\", \"==\", user.customClaims.class), orderBy(\"featuredOrder\", \"asc\"));\n      }\n\n      if (q) {\n        const unsubscribe = onSnapshot(q, (snapshot) => { \n            const prods = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n            setProducts(prods); \n        }); \n        return () => unsubscribe(); \n      }\n  }, [user, adminViewingClass]);\n\n  // Memoized hook to handle filtering and sorting of products\n  const displayedProducts = useMemo(() => {\n    let filtered = [...products];\n    \n    // 1. Search Filter\n    if (searchQuery) {\n      const lowercasedQuery = searchQuery.toLowerCase();\n      filtered = filtered.filter(p => \n        p.name.toLowerCase().includes(lowercasedQuery) ||\n        (p.tags && p.tags.some(tag => tag.toLowerCase().includes(lowercasedQuery)))\n      );\n    }\n\n    // 2. Sorting\n    switch (sortOrder) {\n      case 'price-asc':\n        filtered.sort((a, b) => a.price - b.price);\n        break;\n      case 'price-desc':\n        filtered.sort((a, b) => b.price - a.price);\n        break;\n      case 'rating-desc':\n         filtered.sort((a, b) => b.rating - a.rating);\n        break;\n      case 'newest':\n        // Ensure createdAt exists and has seconds property before sorting\n        filtered.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));\n        break;\n      case 'featured':\n      default:\n        // Default order is already by 'featuredOrder' from the Firestore query\n        break;\n    }\n\n    return filtered;\n  }, [products, searchQuery, sortOrder]);\n  \n  const renderView = () => {\n    if (loading) { return <div className=\"min-h-screen flex items-center justify-center text-lg\">Loading Application...</div> }\n    if (!user) { return <LoginScreen/> }\n    \n    const isSuperAdmin = (user.customClaims && user.customClaims.superAdmin === true) || user.uid === SUPER_ADMIN_UID;\n\n    switch (view.page) {\n      case 'product': \n        const product = products.find(p => p.id === view.id);\n        return product ? <ProductPage product={product} setView={setView} user={user} /> : <div className=\"text-center py-10\">Product not found.</div>;\n      case 'dashboard':\n          return isSuperAdmin \n            ? <main className=\"container mx-auto px-4 py-8\"><SuperAdminDashboard user={user} onEditProduct={(p) => setView({ page: 'create_product', product: p })} /></main>\n            : <main className=\"container mx-auto px-4 py-8\"><VendorDashboard user={user} setView={setView} onEditProduct={(p) => setView({ page: 'create_product', product: p })}/></main>;\n      case 'create_product':\n          return <main className=\"container mx-auto px-4 py-8\"><CreateProductForm setVendorView={() => setView({ page: 'dashboard' })} user={user} editingProduct={view.product} /></main>;\n      case 'home':\n      default:\n        return (\n            <>\n                {isSuperAdmin && <AdminClassSelector classes={classes} adminViewingClass={adminViewingClass} setAdminViewingClass={setAdminViewingClass} />}\n                <ProductGrid products={displayedProducts} setView={setView} sortOrder={sortOrder} setSortOrder={setSortOrder} />\n            </>\n        );\n    }\n  };\n\n  return (\n    <div className=\"bg-gray-50 min-h-screen font-sans\">\n        <Header setView={setView} user={user} onSignOut={handleSignOut} searchQuery={searchQuery} setSearchQuery={setSearchQuery} />\n        {renderView()}\n        <Footer />\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}